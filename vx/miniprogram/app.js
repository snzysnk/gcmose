"use strict";
let resolveUserInfo;
App({
    globalData: {
        userInfo: new Promise((resolve) => {
            resolveUserInfo = resolve;
        })
    },
    onLaunch() {
        let that = this;
        wx.login({
            success: res => {
                wx.request({
                    url: 'http://localhost:9002/v1/auth/login',
                    method: 'POST',
                    data: { code: res.code },
                    timeout: 6000,
                    success: (response) => {
                        let data = response.data;
                        that.setTokenToStorage(data.token, parseInt(data.aging) + Date.parse(Date()) / 1000);
                    },
                    fail: console.log
                });
            },
        });
    },
    parseUserInfo(e) {
        resolveUserInfo(e);
    },
    setTokenToStorage(token, aging) {
        wx.setStorageSync("tokenInfo", JSON.stringify({ token: token, aging: aging }));
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFFQSxJQUFJLGVBQW9CLENBQUM7QUFFekIsR0FBRyxDQUFhO0lBQ1osVUFBVSxFQUFFO1FBQ1IsUUFBUSxFQUFFLElBQUksT0FBTyxDQUFDLENBQUMsT0FBTyxFQUFFLEVBQUU7WUFDOUIsZUFBZSxHQUFHLE9BQU8sQ0FBQztRQUM5QixDQUFDLENBQUM7S0FDTDtJQUNELFFBQVE7UUFDSixJQUFJLElBQUksR0FBRyxJQUFJLENBQUE7UUFDZixFQUFFLENBQUMsS0FBSyxDQUFDO1lBQ0wsT0FBTyxFQUFFLEdBQUcsQ0FBQyxFQUFFO2dCQUNYLEVBQUUsQ0FBQyxPQUFPLENBQUM7b0JBQ1AsR0FBRyxFQUFFLHFDQUFxQztvQkFDMUMsTUFBTSxFQUFFLE1BQU07b0JBQ2QsSUFBSSxFQUFFLEVBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQyxJQUFJLEVBQUM7b0JBQ3RCLE9BQU8sRUFBRSxJQUFJO29CQUNiLE9BQU8sRUFBRSxDQUFDLFFBQVEsRUFBRSxFQUFFO3dCQUNsQixJQUFJLElBQUksR0FBRyxRQUFRLENBQUMsSUFBVyxDQUFDO3dCQUNoQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQTtvQkFDeEYsQ0FBQztvQkFDRCxJQUFJLEVBQUUsT0FBTyxDQUFDLEdBQUc7aUJBQ3BCLENBQUMsQ0FBQztZQUNQLENBQUM7U0FDSixDQUFDLENBQUE7SUFDTixDQUFDO0lBQ0QsYUFBYSxDQUFDLENBQTZCO1FBQ3ZDLGVBQWUsQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUN0QixDQUFDO0lBQ0QsaUJBQWlCLENBQUMsS0FBYSxFQUFFLEtBQWE7UUFDMUMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxXQUFXLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUMsQ0FBQTtJQUNoRixDQUFDO0NBQ0osQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy8gYXBwLnRzXG5cbmxldCByZXNvbHZlVXNlckluZm86IGFueTtcblxuQXBwPElBcHBPcHRpb24+KHtcbiAgICBnbG9iYWxEYXRhOiB7XG4gICAgICAgIHVzZXJJbmZvOiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZVVzZXJJbmZvID0gcmVzb2x2ZTtcbiAgICAgICAgfSlcbiAgICB9LFxuICAgIG9uTGF1bmNoKCkge1xuICAgICAgICBsZXQgdGhhdCA9IHRoaXNcbiAgICAgICAgd3gubG9naW4oe1xuICAgICAgICAgICAgc3VjY2VzczogcmVzID0+IHtcbiAgICAgICAgICAgICAgICB3eC5yZXF1ZXN0KHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo5MDAyL3YxL2F1dGgvbG9naW4nLFxuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICAgICAgZGF0YToge2NvZGU6IHJlcy5jb2RlfSxcbiAgICAgICAgICAgICAgICAgICAgdGltZW91dDogNjAwMCxcbiAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZGF0YSA9IHJlc3BvbnNlLmRhdGEgYXMgYW55O1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhhdC5zZXRUb2tlblRvU3RvcmFnZShkYXRhLnRva2VuLCBwYXJzZUludChkYXRhLmFnaW5nKSArIERhdGUucGFyc2UoRGF0ZSgpKSAvIDEwMDApXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZhaWw6IGNvbnNvbGUubG9nXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KVxuICAgIH0sXG4gICAgcGFyc2VVc2VySW5mbyhlOiBXZWNoYXRNaW5pcHJvZ3JhbS5Vc2VySW5mbykge1xuICAgICAgICByZXNvbHZlVXNlckluZm8oZSlcbiAgICB9LFxuICAgIHNldFRva2VuVG9TdG9yYWdlKHRva2VuOiBzdHJpbmcsIGFnaW5nOiBudW1iZXIpOiB2b2lkIHtcbiAgICAgICAgd3guc2V0U3RvcmFnZVN5bmMoXCJ0b2tlbkluZm9cIiwgSlNPTi5zdHJpbmdpZnkoe3Rva2VuOiB0b2tlbiwgYWdpbmc6IGFnaW5nfSkpXG4gICAgfVxufSkiXX0=