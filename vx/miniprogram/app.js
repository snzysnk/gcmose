"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const util_1 = require("./utils/util");
let resolveUserInfo;
App({
    globalData: {
        userInfo: new Promise((resolve) => {
            resolveUserInfo = resolve;
        })
    },
    onLaunch() {
        let that = this;
        wx.login({
            success: res => {
                wx.request({
                    url: 'http://localhost:9002/v1/auth/login',
                    method: 'POST',
                    data: { code: res.code },
                    timeout: 6000,
                    success: (response) => {
                        let data = response.data;
                        that.setTokenToStorage(data.token, parseInt(data.aging) + Date.parse(Date()) / 1000);
                    },
                    fail: console.log
                });
            },
        });
        console.log("时间", util_1.formatTimeTwo((new Date("1994-01-13")).getTime(), "Y-M-D"));
    },
    parseUserInfo(e) {
        resolveUserInfo(e);
    },
    setTokenToStorage(token, aging) {
        wx.setStorageSync("tokenInfo", JSON.stringify({ token: token, aging: aging }));
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYXBwLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBRUEsdUNBQTJDO0FBRTNDLElBQUksZUFBb0IsQ0FBQztBQUV6QixHQUFHLENBQWE7SUFDWixVQUFVLEVBQUU7UUFDUixRQUFRLEVBQUUsSUFBSSxPQUFPLENBQUMsQ0FBQyxPQUFPLEVBQUUsRUFBRTtZQUM5QixlQUFlLEdBQUcsT0FBTyxDQUFDO1FBQzlCLENBQUMsQ0FBQztLQUNMO0lBQ0QsUUFBUTtRQUNKLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQTtRQUNmLEVBQUUsQ0FBQyxLQUFLLENBQUM7WUFDTCxPQUFPLEVBQUUsR0FBRyxDQUFDLEVBQUU7Z0JBQ1gsRUFBRSxDQUFDLE9BQU8sQ0FBQztvQkFDUCxHQUFHLEVBQUUscUNBQXFDO29CQUMxQyxNQUFNLEVBQUUsTUFBTTtvQkFDZCxJQUFJLEVBQUUsRUFBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLElBQUksRUFBQztvQkFDdEIsT0FBTyxFQUFFLElBQUk7b0JBQ2IsT0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLEVBQUU7d0JBQ2xCLElBQUksSUFBSSxHQUFHLFFBQVEsQ0FBQyxJQUFXLENBQUM7d0JBQ2hDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFBO29CQUN4RixDQUFDO29CQUNELElBQUksRUFBRSxPQUFPLENBQUMsR0FBRztpQkFDcEIsQ0FBQyxDQUFDO1lBQ1AsQ0FBQztTQUNKLENBQUMsQ0FBQTtRQUVGLE9BQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLG9CQUFhLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sRUFBRSxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUE7SUFDakYsQ0FBQztJQUNELGFBQWEsQ0FBQyxDQUE2QjtRQUN2QyxlQUFlLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDdEIsQ0FBQztJQUNELGlCQUFpQixDQUFDLEtBQWEsRUFBRSxLQUFhO1FBQzFDLEVBQUUsQ0FBQyxjQUFjLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDLENBQUE7SUFDaEYsQ0FBQztDQUNKLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vIGFwcC50c1xuXG5pbXBvcnQge2Zvcm1hdFRpbWVUd299IGZyb20gXCIuL3V0aWxzL3V0aWxcIjtcblxubGV0IHJlc29sdmVVc2VySW5mbzogYW55O1xuXG5BcHA8SUFwcE9wdGlvbj4oe1xuICAgIGdsb2JhbERhdGE6IHtcbiAgICAgICAgdXNlckluZm86IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlVXNlckluZm8gPSByZXNvbHZlO1xuICAgICAgICB9KVxuICAgIH0sXG4gICAgb25MYXVuY2goKSB7XG4gICAgICAgIGxldCB0aGF0ID0gdGhpc1xuICAgICAgICB3eC5sb2dpbih7XG4gICAgICAgICAgICBzdWNjZXNzOiByZXMgPT4ge1xuICAgICAgICAgICAgICAgIHd4LnJlcXVlc3Qoe1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICdodHRwOi8vbG9jYWxob3N0OjkwMDIvdjEvYXV0aC9sb2dpbicsXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7Y29kZTogcmVzLmNvZGV9LFxuICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiA2MDAwLFxuICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiAocmVzcG9uc2UpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkYXRhID0gcmVzcG9uc2UuZGF0YSBhcyBhbnk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGF0LnNldFRva2VuVG9TdG9yYWdlKGRhdGEudG9rZW4sIHBhcnNlSW50KGRhdGEuYWdpbmcpICsgRGF0ZS5wYXJzZShEYXRlKCkpIC8gMTAwMClcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbDogY29uc29sZS5sb2dcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc29sZS5sb2coXCLml7bpl7RcIiwgZm9ybWF0VGltZVR3bygobmV3IERhdGUoXCIxOTk0LTAxLTEzXCIpKS5nZXRUaW1lKCksIFwiWS1NLURcIikpXG4gICAgfSxcbiAgICBwYXJzZVVzZXJJbmZvKGU6IFdlY2hhdE1pbmlwcm9ncmFtLlVzZXJJbmZvKSB7XG4gICAgICAgIHJlc29sdmVVc2VySW5mbyhlKVxuICAgIH0sXG4gICAgc2V0VG9rZW5Ub1N0b3JhZ2UodG9rZW46IHN0cmluZywgYWdpbmc6IG51bWJlcik6IHZvaWQge1xuICAgICAgICB3eC5zZXRTdG9yYWdlU3luYyhcInRva2VuSW5mb1wiLCBKU09OLnN0cmluZ2lmeSh7dG9rZW46IHRva2VuLCBhZ2luZzogYWdpbmd9KSlcbiAgICB9XG59KSJdfQ==